!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("scroll-animation-engine",[],r):"object"==typeof exports?exports["scroll-animation-engine"]=r():t["scroll-animation-engine"]=r()}(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=0)}([function(t,r,e){"use strict";e.r(r);var n=0,o="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(t){return window.requestAnimationFrame(t)}:function(t){var r=Date.now(),e=Math.max(0,16.7-(r-n));n=r+e,setTimeout(function(){return t(n)},e)};function a(t){var r=[],e=[],n=0,o=!1,a=0;return{cancel:function(t){var r=e.indexOf(t);-1!==r&&e.splice(r,1)},process:function(){for(o=!0,r=(t=[e,r])[0],(e=t[1]).length=0,n=r.length,a=0;a<n;a++)r[a]();var t;o=!1},schedule:function(a,i){void 0===i&&(i=!1),t();var s=i&&o,l=s?r:e;-1===l.indexOf(a)&&(l.push(a),s&&(n=r.length))}}}"undefined"!=typeof performance&&performance.now;var i=!1,s=40,l=16.7,u=!0,c=0,f=0;function p(){i||(i=!0,u=!0,o(v))}var d=a(p),h=a(p),g=a(p),m=a(p);function v(t){i=!1,f=u?l:Math.max(Math.min(t-c,s),1),u||(l=f),c=t,d.process(),h.process(),g.process(),m.process(),i&&(u=!1)}d.schedule,h.schedule;var y=g.schedule,b=(m.schedule,d.cancel,h.cancel,g.cancel,m.cancel,function(){return(b=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)}),w=function(t,r){return function(e){return Math.max(Math.min(e,r),t)}},O=function(t){return function(r){return"string"==typeof r&&0===r.indexOf(t)}},S=function(t){return t%1?Number(t.toFixed(5)):t},x={test:function(t){return"number"==typeof t},parse:parseFloat,transform:function(t){return t}},k=b({},x,{transform:w(0,1)}),T=b({},x,{default:1}),M=function(t){return{test:function(r){return"string"==typeof r&&r.endsWith(t)&&1===r.split(" ").length},parse:parseFloat,transform:function(r){return""+r+t}}},P=M("deg"),Y=M("%"),A=M("px"),X=(M("vh"),M("vw"),w(0,255)),j=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))$/i,L=function(t){return void 0!==t.red},D=function(t){return void 0!==t.hue},C=function(t){var r=t.length;return function(e){if("string"!=typeof e)return e;for(var n={},o=function(t){return"string"==typeof t?t.split(/,\s*/):[t]}(function(t){return t.substring(t.indexOf("(")+1,t.lastIndexOf(")"))}(e)),a=0;a<r;a++)n[t[a]]=void 0!==o[a]?parseFloat(o[a]):1;return n}},R=b({},x,{transform:function(t){return Math.round(X(t))}}),Z=O("rgb"),E={test:function(t){return"string"==typeof t?Z(t):L(t)},parse:C(["red","green","blue","alpha"]),transform:function(t){var r=t.red,e=t.green,n=t.blue,o=t.alpha;return function(t){var r=t.red,e=t.green,n=t.blue,o=t.alpha;return"rgba("+r+", "+e+", "+n+", "+(void 0===o?1:o)+")"}({red:R.transform(r),green:R.transform(e),blue:R.transform(n),alpha:S(o)})}},F=O("hsl"),z={test:function(t){return"string"==typeof t?F(t):D(t)},parse:C(["hue","saturation","lightness","alpha"]),transform:function(t){var r=t.hue,e=t.saturation,n=t.lightness,o=t.alpha;return function(t){var r=t.hue,e=t.saturation,n=t.lightness,o=t.alpha;return"hsla("+r+", "+e+", "+n+", "+(void 0===o?1:o)+")"}({hue:Math.round(r),saturation:Y.transform(S(e)),lightness:Y.transform(S(n)),alpha:S(o)})}},I=b({},E,{test:O("#"),parse:function(t){var r="",e="",n="";return t.length>4?(r=t.substr(1,2),e=t.substr(3,2),n=t.substr(5,2)):(r=t.substr(1,1),e=t.substr(2,1),n=t.substr(3,1),r+=r,e+=e,n+=n),{red:parseInt(r,16),green:parseInt(e,16),blue:parseInt(n,16),alpha:1}}}),_={test:function(t){return"string"==typeof t&&j.test(t)||E.test(t)||z.test(t)||I.test(t)},parse:function(t){return E.test(t)?E.parse(t):z.test(t)?z.parse(t):I.test(t)?I.parse(t):t},transform:function(t){return L(t)?E.transform(t):D(t)?z.transform(t):t}};var H=function(){return(H=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)};var U,W=function(t){var r=t.onRead,e=t.onRender,n=t.aliasMap,o=void 0===n?{}:n,a=t.useCache,i=void 0===a||a;return function(t){var n={},a=[],s=!1,l=function(t,r){var e=o[t]||t,i=n[e];n[e]=r,n[e]!==i&&(-1===a.indexOf(e)&&a.push(e),s||(s=!0,y(u)))};function u(r){return void 0===r&&(r=!1),(r||s)&&(e(n,t,a),s=!1,a.length=0),this}return{get:function(e){var a=o[e]||e;return a?i&&void 0!==n[a]?n[a]:r(a,t):n},set:function(t,r){if("string"==typeof t){if(void 0===r)return function(r){return l(t,r)};l(t,r)}else for(var e in t)t.hasOwnProperty(e)&&l(e,t[e]);return this},render:u}}},q=/([a-z])([A-Z])/g,B=function(t){return t.replace(q,"$1-$2").toLowerCase()},V=new Map,$=new Map,N=["Webkit","Moz","O","ms",""],G=N.length,J=function(t,r){void 0===r&&(r=!1);var e=r?$:V;return e.has(t)||function(t){if("undefined"!=typeof document){U=U||document.createElement("div");for(var r=0;r<G;r++){var e=N[r],n=""===e,o=n?t:e+t.charAt(0).toUpperCase()+t.slice(1);o in U.style&&(V.set(t,o),$.set(t,(n?"":"-")+B(o)))}}}(t),e.get(t)||t},K=["","X","Y","Z"],Q=["translate","scale","rotate","skew","transformPerspective"].reduce(function(t,r){return K.reduce(function(t,e){return t.push(r+e),t},t)},["x","y","z"]),tt=Q.reduce(function(t,r){return t[r]=!0,t},{}),rt=function(t){return!0===tt[t]},et=function(t,r){return Q.indexOf(t)-Q.indexOf(r)},nt=function(t){return"transformOriginX"===t||"transformOriginY"===t},ot={color:_,backgroundColor:_,outlineColor:_,fill:_,stroke:_,borderColor:_,borderTopColor:_,borderRightColor:_,borderBottomColor:_,borderLeftColor:_,borderRadius:A,width:A,maxWidth:A,height:A,maxHeight:A,top:A,left:A,bottom:A,right:A,rotate:P,rotateX:P,rotateY:P,rotateZ:P,scale:T,scaleX:T,scaleY:T,scaleZ:T,skewX:P,skewY:P,distance:A,translateX:A,translateY:A,translateZ:A,perspective:A,opacity:k,transformOriginX:Y,transformOriginY:Y,transformOriginZ:A},at=function(t){return ot[t]},it="number",st="object",lt="transform-origin",ut="transform",ct="translateZ",ft=";transform: none",pt=function(t,r){return";"+t+":"+r};var dt=new Set(["scrollLeft","scrollTop"]),ht=W({onRead:function(t,r){var e=r.element,n=r.preparseOutput,o=at(t);if(rt(t))return o&&o.default||0;if(dt.has(t))return e[t];var a=window.getComputedStyle(e,null).getPropertyValue(J(t,!0))||0;return n&&o&&o.parse?o.parse(a):a},onRender:function(t,r,e){var n=r.element,o=r.enableHardwareAcceleration;n.style.cssText+=function(t,r,e,n){void 0===r&&(r=!0),void 0===e&&(e=!0);for(var o=!0===r?Object.keys(t):r,a="",i="",s=!1,l=!0,u=!1,c=!1,f=o.length,p=0;p<f;p++){var d=o[p];if(rt(d)){for(var h in u=!0,t)rt(h)&&-1===o.indexOf(h)&&o.push(h);break}}o.sort(et);var g=o.length;for(p=0;p<g;p++)if(d=o[p],!n.has(d)){var m=rt(d),v=t[d],y=at(d);m&&(y.default&&v!==y.default||!y.default&&0!==v)&&(l=!1),y&&(typeof v===it||typeof v===st)&&y.transform&&(v=y.transform(v)),m?(i+=d+"("+v+") ",c=d===ct||c):nt(d)?(t[d]=v,s=!0):a+=pt(J(d,!0),v)}return s&&(a+=pt(lt,(t.transformOriginX||0)+" "+(t.transformOriginY||0)+" "+(t.transformOriginZ||0))),u&&(!c&&e&&(i+=ct+"(0)"),a+=pt(ut,l?ft:i)),a}(t,e,o,dt),-1!==e.indexOf("scrollLeft")&&(n.scrollLeft=t.scrollLeft),-1!==e.indexOf("scrollTop")&&(n.scrollTop=t.scrollTop)},aliasMap:{x:"translateX",y:"translateY",z:"translateZ",originX:"transformOriginX",originY:"transformOriginY",originZ:"transformOriginZ"},uncachedValues:dt}),gt=function(t,r){return t/100*r+"px"},mt={fill:_,stroke:_,scale:T,scaleX:T,scaleY:T,opacity:k,fillOpacity:k,strokeOpacity:k},vt=W({onRead:function(t,r){var e=r.element;if(rt(t)){var n=function(t){return mt[t]}(t);return n?n.default:0}return e.getAttribute(t)},onRender:function(t,r,e){var n=r.dimensions;!function(t,r){for(var e in r)r.hasOwnProperty(e)&&t.setAttribute(e,r[e])}(r.element,function(t,r,e,n){var o=!1,a=!1,i={},s=e?{pathLength:"0",pathSpacing:""+n}:void 0,l=void 0!==t.scale?t.scale||1e-7:t.scaleX||1,u=void 0!==t.scaleY?t.scaleY||1e-7:l||1,c=r.width*((t.originX||50)/100)+r.x,f=r.height*((t.originY||50)/100)+r.y,p=1*l*-c,d=1*u*-f,h=c/l,g=f/u,m={translate:"translate("+t.translateX+", "+t.translateY+") ",scale:"translate("+p+", "+d+") scale("+l+", "+u+") translate("+h+", "+g+") ",rotate:"rotate("+t.rotate+", "+c+", "+f+") ",skewX:"skewX("+t.skewX+") ",skewY:"skewY("+t.skewY+") "};for(var v in t)if(t.hasOwnProperty(v)){var y=t[v];rt(v)?o=!0:!e||"pathLength"!==v&&"pathSpacing"!==v||"number"!=typeof y?e&&"pathOffset"===v?i["stroke-dashoffset"]=gt(-y,n):i[B(v)]=y:(a=!0,s[v]=gt(y,n))}if(a&&(i["stroke-dasharray"]=s.pathLength+" "+s.pathSpacing),o)for(var v in i.transform="",m)if(m.hasOwnProperty(v)){var b="scale"===v?"1":"0";i.transform+=m[v].replace(/undefined/g,b)}return i}(t,n,r.isPath,r.pathLength))},aliasMap:{x:"translateX",y:"translateY",background:"fill"}}),yt=W({useCache:!1,onRead:function(t){return"scrollTop"===t?window.pageYOffset:window.pageXOffset},onRender:function(t){var r=t.scrollTop,e=void 0===r?0:r,n=t.scrollLeft,o=void 0===n?0:n;return window.scrollTo(o,e)}}),bt=new WeakMap,wt=function(t,r){var e;return t instanceof HTMLElement?e=function(t,r){return ht(H({element:t,enableHardwareAcceleration:!0,preparseOutput:!0},r))}(t,r):t instanceof SVGElement?e=function(t){var r=t.getBBox(),e={element:t,dimensions:{x:r.x,y:r.y,width:r.width,height:r.height},isPath:!1};return"path"===t.tagName&&(e.isPath=!0,e.pathLength=t.getTotalLength()),vt(e)}(t):"undefined"!=typeof window&&t===window&&(e=yt(t)),bt.set(t,e),e},Ot=function(t,r){return bt.has(t)?bt.get(t):wt(t,r)};var St=function(t,r){var e="string"==typeof t?document.querySelector(t):t;return Ot(e,r)};function xt(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(e.push(i.value),!r||e.length!==r);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return e}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function kt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tt(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var Mt=function(){function t(){var r=this;!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),Tt(this,"animating",!1),Tt(this,"scrolling",!1),Tt(this,"lastTrackedScrollPosition",window.pageYOffset),Tt(this,"animations",new Map),Tt(this,"onScroll",function(){if(console.log("onScroll"),!r.animating){r.setScrollingState(!0);var t=window.pageYOffset,e=t-r.lastTrackedScrollPosition,n=Math.sign(e);r.isScrollToReact(t,e,n)?r.startAnimationLoop():(r.lastTrackedScrollPosition=t,r.scrollTimeout&&clearTimeout(r.scrollTimeout),r.scrollTimeout=setTimeout(r.setScrollingState,250,!1))}}),Tt(this,"setScrollingState",function(t){r.scrolling!==t&&(r.scrolling=t,r.scrolling?r.onScrollStart():r.onScrollStop())})}return function(t,r,e){r&&kt(t.prototype,r),e&&kt(t,e)}(t,[{key:"startAnimationLoop",value:function(){console.info("startAnimationLoop")}},{key:"computeDragDistanceFromScroll",value:function(t,r,e,n){var o=t-r,a=!0,i=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,f=c.start,p=c.end,d=null===f?o:Math.max(o,f),h=null===p?t:Math.min(t,p),g=1===e?Math.max(h-d,0):Math.min(h-d,0);if(0!==g)return g}}catch(t){i=!0,s=t}finally{try{a||null==u.return||u.return()}finally{if(i)throw s}}return 0}},{key:"isScrollToReact",value:function(t,r,e){var n=!0,o=!1,a=void 0;try{for(var i,s=this.animations[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=xt(i.value,2),u=(l[0],l[1]);if((1!==e||1!==u.progress)&&(-1!==e||0!==u.progress)){var c=1===e?u.scrollDownDragAreas():u.scrollUpDragAreas();this.computeDragDistanceFromScroll(t,r,e,c)}}}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return!1}},{key:"onScrollStart",value:function(){console.log("onScrollStart")}},{key:"onScrollStop",value:function(){console.log("onScrollStop")}},{key:"registerAnimation",value:function(t){var r=t.identifier,e=t.getDomElements,n=t.doInitialDomSetup,o=t.snapOnStop,a=t.distanceToProgress,i=t.scrollDownDragAreas,s=t.scrollUpDragAreas,l=t.render;console.info("registering animation '".concat(r,"'")),0===this.animations.size&&(console.info("registering scroll handler"),window.addEventListener("scroll",this.onScroll)),console.log("getting dom references and initializing stylers for '".concat(r,"'"));for(var u={},c=e(),f=Object.keys(c),p=0;p<f.length;p++){var d=f[p],h=c[d];u[d]={element:h,styler:St(h)}}n(u),this.animations.set(r,{progress:0,snapOnStop:o,distanceToProgress:a,scrollDownDragAreas:i,scrollUpDragAreas:s,domElements:u,render:l})}}]),t}();r.default=Mt}])});